<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.11"/>
		<title>Luwra: Main Page</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
		<div id="top">
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Luwra Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://gitter.im/vapourismo/luwra"></a> <a href="https://travis-ci.org/vapourismo/luwra"></a> </p><h1>Luwra</h1>
<p>A header-only C++ library which provides a Lua wrapper with minimal overhead.</p>
<h2>Usage</h2>
<p>Refer to the <a href="https://github.com/vapourismo/luwra/wiki">wiki pages</a> or the <a href="http://vapourismo.github.io/luwra/docs">documentation</a>. In order to use the library you must clone this repository and include <code>lib/luwra.hpp</code>.</p>
<p>Have a question? Simply <a href="https://gitter.im/vapourismo/luwra">ask</a> or open an issue.</p>
<h2>Examples</h2>
<p>In the following examples <code>lua</code> refers to an instance of <code>lua_State*</code>.</p>
<p>Easily push values onto the stack:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// Push an integer</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;luwra::push(lua, 1338);</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;// Push a number</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;luwra::push(lua, 13.37);</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;// Push a boolean</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;luwra::push(lua, false);</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;// Push a string</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;luwra::push(lua, &quot;Hello World&quot;);</div></div><!-- fragment --><p>Or retrieve them:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// Your function</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;int my_fun(int a, int b) {</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    return a + b;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;// Prepare stack</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;luwra::push(lua, 13);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;luwra::push(lua, 37);</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;// Apply your function</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;int result = luwra::apply(lua, my_fun);</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;// which is equivalent to</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;int result = luwra::apply(lua, 1, my_fun);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;// and equivalent to</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;int result = luwra::apply(lua, -2, my_fun);</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;// All of this is essentially syntactic sugar for</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;int result = my_fun(luwra::read&lt;int&gt;(lua, 1), luwra::read&lt;int&gt;(lua, 2));</div></div><!-- fragment --><p>Generate a C function which can be used by Lua:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;// Assuming your function looks something like this</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;int my_function(const char* a, int b) {</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    // ...</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;}</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;// Convert to lua_CFunction</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;lua_CFunction cfun = LUWRA_WRAP(my_function);</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;// Do something with it, for example set it as a Lua global function</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;luwra::setGlobal(lua, &quot;my_function&quot;, cfun);</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;-- Invoke the registered function</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;local my_result = my_function(&quot;Hello World&quot;, 1337)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;print(my_result)</div></div><!-- fragment --><p>Or register your own class:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{c++}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;struct Point {</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    double x, y;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    Point(double x, double y):</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        x(x), y(y)</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    {</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        std::cout &lt;&lt; &quot;Construct Point(&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    }</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    ~Point() {</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        std::cout &lt;&lt; &quot;Destruct Point(&quot; &lt;&lt; x &lt;&lt; &quot;, &quot; &lt;&lt; y &lt;&lt; &quot;)&quot; &lt;&lt; std::endl;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    }</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    void scale(double f) {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        x *= f;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        y *= f;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    }</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    std::string __tostring() {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        return &quot;&lt;Point(&quot; + std::to_string(x) + &quot;, &quot; + std::to_string(y) + &quot;)&gt;&quot;;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    }</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;};</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;// Register the metatable and constructor</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;luwra::registerUserType&lt;Point(double, double)&gt;(</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    lua,</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    // Constructor name</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    &quot;Point&quot;,</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    // Methods need to be declared here</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        LUWRA_MEMBER(Point, scale),</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        LUWRA_MEMBER(Point, x),</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        LUWRA_MEMBER(Point, y)</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    },</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    // Meta methods may be registered aswell</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        LUWRA_MEMBER(Point, __tostring)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;);</div></div><!-- fragment --><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;-- Instantiate &#39;Point&#39;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;local point = Point(13, 37)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;-- Invoke &#39;scale&#39; method</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;point:scale(1.5)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;-- Convert to string via &#39;__tostring&#39; meta method</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;print(point)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;-- Read properties &#39;x&#39; and &#39;y&#39;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;print(point:x(), point:y())</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;-- Set property &#39;x&#39;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;point:x(4.2)</div></div><!-- fragment --><h2>Requirements</h2>
<p>You need a C++11-compliant compiler and at least Lua 5.1 to get this library to work. I recommend using Lua 5.3 or later, to avoid the messy <code>lua_Integer</code> situation. LuaJIT 2.0 seems to work, apart from user types, which fail for yet unknown reasons.</p>
<h2>Tests</h2>
<p>The attached GNU <code>Makefile</code> allows you to run both examples and tests using <code>make examples</code> and <code>make test</code> respectively. You might need to adjust <code>LUA_*</code> variables, so Luwra finds the Lua headers and library.</p>
<p>Assuming all headers are located in <code>/usr/include/lua5.3</code> and the shared object name is <code>liblua5.3.so</code>, you need to invoke this:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;make LUA_INCDIR=/usr/include/lua5.3 LUA_LIBNAME=lua5.3 test</div></div><!-- fragment --> </div></div><!-- contents -->
	</body>
</html>
